import{_ as wt}from"../../../chunks/preload-helper-e4860ae8.js";import{S as ue,i as ce,s as de,F as Qe,C as V,e as q,k as U,w as E,c as G,m as H,a as B,x as A,d as k,b as I,W as O,V as we,g as C,K as F,y as N,X as Y,a7 as yt,G as Je,H as Xe,I as xe,z as ve,q as y,o as S,B as D,Y as Me,R as ne,$ as Pe,T as oe,U as me,L as Q,O as ee,t as K,P as te,h as W,j as fe,Q as ye,E as ge,M as X,N as x,J as Ee,l as le,f as re,n as he,a8 as $e,a9 as et,p as _e,a3 as vt,v as tt,aa as nt,a6 as Ce,a5 as St}from"../../../chunks/index-61eb6ca2.js";import{C as Ct,l as $,M as Tt,b as Et,d as At,c as Ae,t as Nt,g as Dt,h as Mt,r as Pt,i as It,G as Lt,o as zt,p as Bt,f as Ne,m as Ot,v as Ft,A as Ut,u as Ht,N as Rt,R as Vt}from"../../../chunks/NotificationPopover-71ba6e02.js";import{B as De,g as Te,M as jt,a as Zt,p as Yt}from"../../../chunks/stores-22ceb076.js";import{C as qt,S as Gt,a as Kt,L as Wt,I as Qt,H as Jt,b as Xt,c as xt}from"../../../chunks/SimpleInputDialog-5480a7ed.js";import{A as ze}from"../../../chunks/ArrowLeft-f1af7a25.js";import{C as $t,s as en}from"../../../chunks/stateStore-d4ae1494.js";import"../../../chunks/index-193ed16b.js";import"../../../chunks/singletons-d1fb5791.js";function tn(i){let e,t,n,r,a,s,l,o,u,p,d;a=new qt({props:{"aria-label":i[7],title:i[7]}});const c=i[12].default,f=Qe(c,i,i[11],null);let g=[{for:i[8]},{tabindex:o=i[3]?void 0:i[6]},i[10]],b={};for(let h=0;h<g.length;h+=1)b=V(b,g[h]);return{c(){e=q("input"),t=U(),n=q("label"),r=q("span"),E(a.$$.fragment),s=U(),l=q("span"),f&&f.c(),this.h()},l(h){e=G(h,"INPUT",{type:!0,tabindex:!0,id:!0,name:!0,title:!0}),t=H(h),n=G(h,"LABEL",{for:!0,tabindex:!0});var T=B(n);r=G(T,"SPAN",{});var M=B(r);A(a.$$.fragment,M),M.forEach(k),s=H(T),l=G(T,"SPAN",{});var m=B(l);f&&f.l(m),m.forEach(k),T.forEach(k),this.h()},h(){I(e,"type","checkbox"),I(e,"tabindex","-1"),e.checked=i[0],I(e,"id",i[8]),e.value=i[5],I(e,"name",i[9]),I(e,"title",i[4]),e.disabled=i[3],O(e,"bx--tile-input",!0),O(r,"bx--tile__checkmark",!0),O(l,"bx--tile-content",!0),we(n,b),O(n,"bx--tile",!0),O(n,"bx--tile--selectable",!0),O(n,"bx--tile--is-selected",i[0]),O(n,"bx--tile--light",i[2]),O(n,"bx--tile--disabled",i[3])},m(h,T){C(h,e,T),i[18](e),C(h,t,T),C(h,n,T),F(n,r),N(a,r,null),F(n,s),F(n,l),f&&f.m(l,null),u=!0,p||(d=[Y(n,"click",i[13]),Y(n,"click",yt(i[19])),Y(n,"mouseover",i[14]),Y(n,"mouseenter",i[15]),Y(n,"mouseleave",i[16]),Y(n,"keydown",i[17]),Y(n,"keydown",i[20])],p=!0)},p(h,[T]){(!u||T&1)&&(e.checked=h[0]),(!u||T&256)&&I(e,"id",h[8]),(!u||T&32)&&(e.value=h[5]),(!u||T&512)&&I(e,"name",h[9]),(!u||T&16)&&I(e,"title",h[4]),(!u||T&8)&&(e.disabled=h[3]);const M={};T&128&&(M["aria-label"]=h[7]),T&128&&(M.title=h[7]),a.$set(M),f&&f.p&&(!u||T&2048)&&Je(f,c,h,h[11],u?xe(c,h[11],T,null):Xe(h[11]),null),we(n,b=ve(g,[(!u||T&256)&&{for:h[8]},(!u||T&72&&o!==(o=h[3]?void 0:h[6]))&&{tabindex:o},T&1024&&h[10]])),O(n,"bx--tile",!0),O(n,"bx--tile--selectable",!0),O(n,"bx--tile--is-selected",h[0]),O(n,"bx--tile--light",h[2]),O(n,"bx--tile--disabled",h[3])},i(h){u||(y(a.$$.fragment,h),y(f,h),u=!0)},o(h){S(a.$$.fragment,h),S(f,h),u=!1},d(h){h&&k(e),i[18](null),h&&k(t),h&&k(n),D(a),f&&f.d(h),p=!1,Me(d)}}}function nn(i,e,t){const n=["selected","light","disabled","title","value","tabindex","iconDescription","id","name","ref"];let r=ne(e,n),{$$slots:a={},$$scope:s}=e,{selected:l=!1}=e,{light:o=!1}=e,{disabled:u=!1}=e,{title:p="title"}=e,{value:d="value"}=e,{tabindex:c="0"}=e,{iconDescription:f="Tile checkmark"}=e,{id:g="ccs-"+Math.random().toString(36)}=e,{name:b=""}=e,{ref:h=null}=e;const T=Pe();function M(_){me.call(this,i,_)}function m(_){me.call(this,i,_)}function v(_){me.call(this,i,_)}function R(_){me.call(this,i,_)}function j(_){me.call(this,i,_)}function Z(_){Q[_?"unshift":"push"](()=>{h=_,t(1,h)})}const L=()=>{u||t(0,l=!l)},ie=_=>{u||(_.key===" "||_.key==="Enter")&&(_.preventDefault(),t(0,l=!l))};return i.$$set=_=>{e=V(V({},e),oe(_)),t(10,r=ne(e,n)),"selected"in _&&t(0,l=_.selected),"light"in _&&t(2,o=_.light),"disabled"in _&&t(3,u=_.disabled),"title"in _&&t(4,p=_.title),"value"in _&&t(5,d=_.value),"tabindex"in _&&t(6,c=_.tabindex),"iconDescription"in _&&t(7,f=_.iconDescription),"id"in _&&t(8,g=_.id),"name"in _&&t(9,b=_.name),"ref"in _&&t(1,h=_.ref),"$$scope"in _&&t(11,s=_.$$scope)},i.$$.update=()=>{i.$$.dirty&265&&(u||T(l?"select":"deselect",g))},[l,h,o,u,p,d,c,f,g,b,r,s,a,M,m,v,R,j,Z,L,ie]}class ln extends ue{constructor(e){super(),ce(this,e,nn,tn,de,{selected:0,light:2,disabled:3,title:4,value:5,tabindex:6,iconDescription:7,id:8,name:9,ref:1})}}var sn=ln;function Be(i){let e,t;return{c(){e=ee("title"),t=K(i[1])},l(n){e=te(n,"title",{});var r=B(e);t=W(r,i[1]),r.forEach(k)},m(n,r){C(n,e,r),F(e,t)},p(n,r){r&2&&fe(t,n[1])},d(n){n&&k(e)}}}function rn(i){let e,t,n,r=i[1]&&Be(i),a=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:i[0]},{height:i[0]},i[2],i[3]],s={};for(let l=0;l<a.length;l+=1)s=V(s,a[l]);return{c(){e=ee("svg"),r&&r.c(),t=ee("path"),n=ee("path"),this.h()},l(l){e=te(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var o=B(e);r&&r.l(o),t=te(o,"path",{d:!0}),B(t).forEach(k),n=te(o,"path",{d:!0}),B(n).forEach(k),o.forEach(k),this.h()},h(){I(t,"d","M26,4H6A2,2,0,0,0,4,6V26a2,2,0,0,0,2,2H26a2,2,0,0,0,2-2V6A2,2,0,0,0,26,4ZM6,26V6H26V26Z"),I(n,"d","M14 21.5L9 16.54 10.59 15 14 18.35 21.41 11 23 12.58 14 21.5z"),ye(e,s)},m(l,o){C(l,e,o),r&&r.m(e,null),F(e,t),F(e,n)},p(l,[o]){l[1]?r?r.p(l,o):(r=Be(l),r.c(),r.m(e,t)):r&&(r.d(1),r=null),ye(e,s=ve(a,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},o&1&&{width:l[0]},o&1&&{height:l[0]},o&4&&l[2],o&8&&l[3]]))},i:ge,o:ge,d(l){l&&k(e),r&&r.d()}}}function an(i,e,t){let n,r;const a=["size","title"];let s=ne(e,a),{size:l=16}=e,{title:o=void 0}=e;return i.$$set=u=>{t(5,e=V(V({},e),oe(u))),t(3,s=ne(e,a)),"size"in u&&t(0,l=u.size),"title"in u&&t(1,o=u.title)},i.$$.update=()=>{t(4,n=e["aria-label"]||e["aria-labelledby"]||o),t(2,r={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=oe(e),[l,o,r,s,n]}class on extends ue{constructor(e){super(),ce(this,e,an,rn,de,{size:0,title:1})}}function Oe(i){let e,t;return{c(){e=ee("title"),t=K(i[1])},l(n){e=te(n,"title",{});var r=B(e);t=W(r,i[1]),r.forEach(k)},m(n,r){C(n,e,r),F(e,t)},p(n,r){r&2&&fe(t,n[1])},d(n){n&&k(e)}}}function fn(i){let e,t,n=i[1]&&Oe(i),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:i[0]},{height:i[0]},i[2],i[3]],a={};for(let s=0;s<r.length;s+=1)a=V(a,r[s]);return{c(){e=ee("svg"),n&&n.c(),t=ee("path"),this.h()},l(s){e=te(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var l=B(e);n&&n.l(l),t=te(l,"path",{d:!0}),B(t).forEach(k),l.forEach(k),this.h()},h(){I(t,"d","M26,4H6A2,2,0,0,0,4,6V26a2,2,0,0,0,2,2H26a2,2,0,0,0,2-2V6A2,2,0,0,0,26,4ZM6,26V6H26V26Z"),ye(e,a)},m(s,l){C(s,e,l),n&&n.m(e,null),F(e,t)},p(s,[l]){s[1]?n?n.p(s,l):(n=Oe(s),n.c(),n.m(e,t)):n&&(n.d(1),n=null),ye(e,a=ve(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},l&1&&{width:s[0]},l&1&&{height:s[0]},l&4&&s[2],l&8&&s[3]]))},i:ge,o:ge,d(s){s&&k(e),n&&n.d()}}}function un(i,e,t){let n,r;const a=["size","title"];let s=ne(e,a),{size:l=16}=e,{title:o=void 0}=e;return i.$$set=u=>{t(5,e=V(V({},e),oe(u))),t(3,s=ne(e,a)),"size"in u&&t(0,l=u.size),"title"in u&&t(1,o=u.title)},i.$$.update=()=>{t(4,n=e["aria-label"]||e["aria-labelledby"]||o),t(2,r={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=oe(e),[l,o,r,s,n]}class cn extends ue{constructor(e){super(),ce(this,e,un,fn,de,{size:0,title:1})}}function Fe(i,e,t){const n=i.slice();return n[10]=e[t],n[11]=e,n[12]=t,n}function dn(i){let e=(i[10].number?i[10].number:i[12]+1)+"",t,n,r=i[10].name+"",a;return{c(){t=K(e),n=K(". "),a=K(r)},l(s){t=W(s,e),n=W(s,". "),a=W(s,r)},m(s,l){C(s,t,l),C(s,n,l),C(s,a,l)},p(s,l){l&1&&e!==(e=(s[10].number?s[10].number:s[12]+1)+"")&&fe(t,e),l&1&&r!==(r=s[10].name+"")&&fe(a,r)},d(s){s&&k(t),s&&k(n),s&&k(a)}}}function Ue(i,e){let t,n,r,a;function s(o){e[7](o,e[12])}let l={$$slots:{default:[dn]},$$scope:{ctx:e}};return e[0][e[12]].selected!==void 0&&(l.selected=e[0][e[12]].selected),n=new sn({props:l}),Q.push(()=>X(n,"selected",s)),{key:i,first:null,c(){t=le(),E(n.$$.fragment),this.h()},l(o){t=le(),A(n.$$.fragment,o),this.h()},h(){this.first=t},m(o,u){C(o,t,u),N(n,o,u),a=!0},p(o,u){e=o;const p={};u&8193&&(p.$$scope={dirty:u,ctx:e}),!r&&u&1&&(r=!0,p.selected=e[0][e[12]].selected,x(()=>r=!1)),n.$set(p)},i(o){a||(y(n.$$.fragment,o),a=!0)},o(o){S(n.$$.fragment,o),a=!1},d(o){o&&k(t),D(n,o)}}}function pn(i){let e,t,n,r,a,s=[],l=new Map,o,u;t=new De({props:{size:"small",hasIconOnly:!0,kind:"secondary",iconDescription:"Select None",icon:cn}}),t.$on("click",i[4]),r=new De({props:{size:"small",hasIconOnly:!0,kind:"secondary",iconDescription:"Select All",icon:on}}),r.$on("click",i[5]);let p=i[0];const d=c=>c[10].id;for(let c=0;c<p.length;c+=1){let f=Fe(i,p,c),g=d(f);l.set(g,s[c]=Ue(g,f))}return{c(){e=q("div"),E(t.$$.fragment),n=U(),E(r.$$.fragment),a=U();for(let c=0;c<s.length;c+=1)s[c].c();o=le(),this.h()},l(c){e=G(c,"DIV",{style:!0});var f=B(e);A(t.$$.fragment,f),n=H(f),A(r.$$.fragment,f),f.forEach(k),a=H(c);for(let g=0;g<s.length;g+=1)s[g].l(c);o=le(),this.h()},h(){re(e,"display","flex"),re(e,"justify-content","flex-end")},m(c,f){C(c,e,f),N(t,e,null),F(e,n),N(r,e,null),C(c,a,f);for(let g=0;g<s.length;g+=1)s[g].m(c,f);C(c,o,f),u=!0},p(c,f){f&1&&(p=c[0],he(),s=$e(s,f,d,1,c,p,l,o.parentNode,et,Ue,o,Fe),_e())},i(c){if(!u){y(t.$$.fragment,c),y(r.$$.fragment,c);for(let f=0;f<p.length;f+=1)y(s[f]);u=!0}},o(c){S(t.$$.fragment,c),S(r.$$.fragment,c);for(let f=0;f<s.length;f+=1)S(s[f]);u=!1},d(c){c&&k(e),D(t),D(r),c&&k(a);for(let f=0;f<s.length;f+=1)s[f].d(c);c&&k(o)}}}function mn(i){let e,t,n,r,a,s;return e=new Tt({props:{label:"Import",title:"Select Scenes"}}),n=new Et({props:{hasForm:!0,style:"overflow-x: hidden",$$slots:{default:[pn]},$$scope:{ctx:i}}}),a=new At({props:{primaryButtonText:"Import",primaryButtonDisabled:!i[2],primaryClass:"bx--btn--secondary"}}),{c(){E(e.$$.fragment),t=U(),E(n.$$.fragment),r=U(),E(a.$$.fragment)},l(l){A(e.$$.fragment,l),t=H(l),A(n.$$.fragment,l),r=H(l),A(a.$$.fragment,l)},m(l,o){N(e,l,o),C(l,t,o),N(n,l,o),C(l,r,o),N(a,l,o),s=!0},p(l,o){const u={};o&8193&&(u.$$scope={dirty:o,ctx:l}),n.$set(u);const p={};o&4&&(p.primaryButtonDisabled=!l[2]),a.$set(p)},i(l){s||(y(e.$$.fragment,l),y(n.$$.fragment,l),y(a.$$.fragment,l),s=!0)},o(l){S(e.$$.fragment,l),S(n.$$.fragment,l),S(a.$$.fragment,l),s=!1},d(l){D(e,l),l&&k(t),D(n,l),l&&k(r),D(a,l)}}}function hn(i){let e,t,n;function r(s){i[8](s)}let a={preventCloseOnClickOutside:!0,size:"sm",$$slots:{default:[mn]},$$scope:{ctx:i}};return i[1]!==void 0&&(a.open=i[1]),e=new Ct({props:a}),Q.push(()=>X(e,"open",r)),e.$on("submit",i[3]),{c(){E(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,l){N(e,s,l),n=!0},p(s,[l]){const o={};l&8197&&(o.$$scope={dirty:l,ctx:s}),!t&&l&2&&(t=!0,o.open=s[1],x(()=>t=!1)),e.$set(o)},i(s){n||(y(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){D(e,s)}}}function _n(i,e,t){let n;Ee(i,$,f=>t(9,n=f));let{open:r=!1}=e,{imported:a=[]}=e,{script_id:s}=e;function l(){let f=n.scripts.findIndex(g=>g.id===s);if(f!==-1){for(let g=a.length-1;g>=0;g--){let b=a[g];!b.selected||(delete b.selected,n.scripts[f].scenes.unshift(b))}$.set(n)}t(0,a=[]),t(1,r=!1)}function o(){for(let f=0;f<a.length;f++)t(0,a[f].selected=!1,a)}function u(){for(let f=0;f<a.length;f++)t(0,a[f].selected=!0,a)}let p=!0;function d(f,g){i.$$.not_equal(a[g].selected,f)&&(a[g].selected=f,t(0,a))}function c(f){r=f,t(1,r)}return i.$$set=f=>{"open"in f&&t(1,r=f.open),"imported"in f&&t(0,a=f.imported),"script_id"in f&&t(6,s=f.script_id)},i.$$.update=()=>{if(i.$$.dirty&1){t(2,p=!1);for(let f=0;f<a.length;f++)if(a[f].selected===!0){t(2,p=!0);break}}},[a,r,p,l,o,u,s,d,c]}class gn extends ue{constructor(e){super(),ce(this,e,_n,hn,de,{open:1,imported:0,script_id:6})}}const bn=i=>({}),He=i=>({});function kn(i){let e;return{c(){e=K(i[2])},l(t){e=W(t,i[2])},m(t,n){C(t,e,n)},p(t,n){n&4&&fe(e,t[2])},d(t){t&&k(e)}}}function wn(i){let e,t,n,r,a,s,l,o,u;const p=i[15].labelText,d=Qe(p,i,i[14],He),c=d||kn(i);let f=[{type:"file"},{tabindex:"-1"},{accept:i[3]},{disabled:i[5]},{id:i[10]},{multiple:i[4]},{name:i[11]},i[13]],g={};for(let b=0;b<f.length;b+=1)g=V(g,f[b]);return{c(){e=q("label"),t=q("span"),c&&c.c(),a=U(),s=q("input"),this.h()},l(b){e=G(b,"LABEL",{"aria-disabled":!0,for:!0,tabindex:!0,class:!0});var h=B(e);t=G(h,"SPAN",{role:!0});var T=B(t);c&&c.l(T),T.forEach(k),h.forEach(k),a=H(b),s=G(b,"INPUT",{type:!0,tabindex:!0,accept:!0,id:!0,name:!0}),this.h()},h(){I(t,"role",i[8]),I(e,"aria-disabled",i[5]),I(e,"for",i[10]),I(e,"tabindex",n=i[5]?"-1":i[9]),I(e,"class",r=i[7]&&`bx--btn--${i[7]}`),O(e,"bx--btn",!0),O(e,"bx--btn--sm",!0),O(e,"bx--btn--disabled",i[5]),we(s,g),O(s,"bx--visually-hidden",!0)},m(b,h){C(b,e,h),F(e,t),c&&c.m(t,null),C(b,a,h),C(b,s,h),s.autofocus&&s.focus(),i[19](s),l=!0,o||(u=[Y(e,"keydown",i[17]),Y(e,"keydown",i[18]),Y(s,"change",vt(i[20])),Y(s,"click",i[16]),Y(s,"click",yn)],o=!0)},p(b,[h]){d?d.p&&(!l||h&16384)&&Je(d,p,b,b[14],l?xe(p,b[14],h,bn):Xe(b[14]),He):c&&c.p&&(!l||h&4)&&c.p(b,l?h:-1),(!l||h&256)&&I(t,"role",b[8]),(!l||h&32)&&I(e,"aria-disabled",b[5]),(!l||h&1024)&&I(e,"for",b[10]),(!l||h&544&&n!==(n=b[5]?"-1":b[9]))&&I(e,"tabindex",n),(!l||h&128&&r!==(r=b[7]&&`bx--btn--${b[7]}`))&&I(e,"class",r),h&128&&O(e,"bx--btn",!0),h&128&&O(e,"bx--btn--sm",!0),h&160&&O(e,"bx--btn--disabled",b[5]),we(s,g=ve(f,[{type:"file"},{tabindex:"-1"},(!l||h&8)&&{accept:b[3]},(!l||h&32)&&{disabled:b[5]},(!l||h&1024)&&{id:b[10]},(!l||h&16)&&{multiple:b[4]},(!l||h&2048)&&{name:b[11]},h&8192&&b[13]])),O(s,"bx--visually-hidden",!0)},i(b){l||(y(c,b),l=!0)},o(b){S(c,b),l=!1},d(b){b&&k(e),c&&c.d(b),b&&k(a),b&&k(s),i[19](null),o=!1,Me(u)}}}const yn=({target:i})=>{i.value=null};function vn(i,e,t){const n=["accept","files","multiple","disabled","disableLabelChanges","kind","labelText","role","tabindex","id","name","ref"];let r=ne(e,n),{$$slots:a={},$$scope:s}=e,{accept:l=[]}=e,{files:o=[]}=e,{multiple:u=!1}=e,{disabled:p=!1}=e,{disableLabelChanges:d=!1}=e,{kind:c="primary"}=e,{labelText:f="Add file"}=e,{role:g="button"}=e,{tabindex:b="0"}=e,{id:h="ccs-"+Math.random().toString(36)}=e,{name:T=""}=e,{ref:M=null}=e;const m=Pe();let v=f;function R(_){me.call(this,i,_)}function j(_){me.call(this,i,_)}const Z=({key:_})=>{(_===" "||_==="Enter")&&M.click()};function L(_){Q[_?"unshift":"push"](()=>{M=_,t(1,M),t(0,o),t(21,v)})}const ie=({target:_})=>{t(0,o=[..._.files]),o&&!d&&t(2,f=o.length>1?`${o.length} files`:o[0].name),m("change",o)};return i.$$set=_=>{e=V(V({},e),oe(_)),t(13,r=ne(e,n)),"accept"in _&&t(3,l=_.accept),"files"in _&&t(0,o=_.files),"multiple"in _&&t(4,u=_.multiple),"disabled"in _&&t(5,p=_.disabled),"disableLabelChanges"in _&&t(6,d=_.disableLabelChanges),"kind"in _&&t(7,c=_.kind),"labelText"in _&&t(2,f=_.labelText),"role"in _&&t(8,g=_.role),"tabindex"in _&&t(9,b=_.tabindex),"id"in _&&t(10,h=_.id),"name"in _&&t(11,T=_.name),"ref"in _&&t(1,M=_.ref),"$$scope"in _&&t(14,s=_.$$scope)},i.$$.update=()=>{i.$$.dirty&3&&M&&o.length===0&&(t(2,f=v),t(1,M.value=null,M))},[o,M,f,l,u,p,d,c,g,b,h,T,m,r,s,a,R,j,Z,L,ie]}class Sn extends ue{constructor(e){super(),ce(this,e,vn,wn,de,{accept:3,files:0,multiple:4,disabled:5,disableLabelChanges:6,kind:7,labelText:2,role:8,tabindex:9,id:10,name:11,ref:1})}}var Cn=Sn;function Re(i){let e,t;return{c(){e=ee("title"),t=K(i[1])},l(n){e=te(n,"title",{});var r=B(e);t=W(r,i[1]),r.forEach(k)},m(n,r){C(n,e,r),F(e,t)},p(n,r){r&2&&fe(t,n[1])},d(n){n&&k(e)}}}function Tn(i){let e,t,n=i[1]&&Re(i),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:i[0]},{height:i[0]},i[2],i[3]],a={};for(let s=0;s<r.length;s+=1)a=V(a,r[s]);return{c(){e=ee("svg"),n&&n.c(),t=ee("path"),this.h()},l(s){e=te(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var l=B(e);n&&n.l(l),t=te(l,"path",{d:!0}),B(t).forEach(k),l.forEach(k),this.h()},h(){I(t,"d","M6 18L7.41 19.41 15 11.83 15 30 17 30 17 11.83 24.59 19.41 26 18 16 8 6 18zM6 8V4H26V8h2V4a2 2 0 00-2-2H6A2 2 0 004 4V8z"),ye(e,a)},m(s,l){C(s,e,l),n&&n.m(e,null),F(e,t)},p(s,[l]){s[1]?n?n.p(s,l):(n=Re(s),n.c(),n.m(e,t)):n&&(n.d(1),n=null),ye(e,a=ve(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},l&1&&{width:s[0]},l&1&&{height:s[0]},l&4&&s[2],l&8&&s[3]]))},i:ge,o:ge,d(s){s&&k(e),n&&n.d()}}}function En(i,e,t){let n,r;const a=["size","title"];let s=ne(e,a),{size:l=16}=e,{title:o=void 0}=e;return i.$$set=u=>{t(5,e=V(V({},e),oe(u))),t(3,s=ne(e,a)),"size"in u&&t(0,l=u.size),"title"in u&&t(1,o=u.title)},i.$$.update=()=>{t(4,n=e["aria-label"]||e["aria-labelledby"]||o),t(2,r={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=oe(e),[l,o,r,s,n]}class An extends ue{constructor(e){super(),ce(this,e,En,Tn,de,{size:0,title:1})}}function Nn(i){let e,t,n,r,a,s,l,o;function u(f){i[5](f)}let p={skeleton:i[0],kind:"secondary",hasIconOnly:!0,icon:An,iconDescription:"Import Scenes"};i[2]!==void 0&&(p.ref=i[2]),t=new De({props:p}),Q.push(()=>X(t,"ref",u)),t.$on("click",i[6]);function d(f){i[7](f)}let c={kind:"ghost",accept:[".fountain",".fou",".txt",".spmd",".fdx"],style:"display: none",labelText:""};return i[1]!==void 0&&(c.ref=i[1]),a=new Cn({props:c}),Q.push(()=>X(a,"ref",d)),a.$on("change",i[4]),{c(){e=q("div"),E(t.$$.fragment),r=U(),E(a.$$.fragment),this.h()},l(f){e=G(f,"DIV",{style:!0});var g=B(e);A(t.$$.fragment,g),r=H(g),A(a.$$.fragment,g),g.forEach(k),this.h()},h(){I(e,"style",l=i[3]?"display: inline":"display: none")},m(f,g){C(f,e,g),N(t,e,null),F(e,r),N(a,e,null),o=!0},p(f,[g]){const b={};g&1&&(b.skeleton=f[0]),!n&&g&4&&(n=!0,b.ref=f[2],x(()=>n=!1)),t.$set(b);const h={};!s&&g&2&&(s=!0,h.ref=f[1],x(()=>s=!1)),a.$set(h),(!o||g&8&&l!==(l=f[3]?"display: inline":"display: none"))&&I(e,"style",l)},i(f){o||(y(t.$$.fragment,f),y(a.$$.fragment,f),o=!0)},o(f){S(t.$$.fragment,f),S(a.$$.fragment,f),o=!1},d(f){f&&k(e),D(t),D(a)}}}function Dn(i,e,t){const n=Pe();function r(c){n("change",c.detail)}let a,s,l=!1,{inProgress:o=!1}=e;tt(async()=>{let c=a.previousElementSibling;s?c.parentNode.replaceChild(s,c):c.parentNode.replaceChild(a.previousElementSibling.previousElementSibling,c),t(3,l=!0)});function u(c){s=c,t(2,s)}const p=()=>{o||a.click()};function d(c){a=c,t(1,a)}return i.$$set=c=>{"inProgress"in c&&t(0,o=c.inProgress)},[o,a,s,l,r,u,p,d]}class Mn extends ue{constructor(e){super(),ce(this,e,Dn,Nn,de,{inProgress:0})}}const P={title_page:/^((?:title|credit|author[s]?|source|notes|draft date|date|contact|copyright)\:)/gim,scene_heading:/^((?:\*{0,3}_?)?(?:(?:int|ext|est|i\/e)[. ]).+)|^(?:\.(?!\.+))(.+)/i,scene_number:/( *#(.+)# *)/,transition:/^((?:FADE (?:TO BLACK|OUT)|CUT TO BLACK)\.|.+ TO\:)|^(?:> *)(.+)/,dialogue:/^(?:([A-Z*_][0-9A-Z ._\-']*(?:\(.*\))?[ ]*)|\@([A-Za-z*_][0-9A-Za-z (._\-')]*))(\^?)?(?:\n(?!\n+))([\s\S]+)/,parenthetical:/^(\(.+\))$/,action:/^(.+)/g,centered:/^(?:> *)(.+)(?: *<)(\n.+)*/g,lyrics:/^~(?![ ]).+(?:\n.+)*/,section:/^(#+)(?: *)(.*)/,synopsis:/^(?:\=(?!\=+) *)(.*)/,note:/^(?:\[{2}(?!\[+))(.+)(?:\]{2}(?!\[+))$/,note_inline:/(?:\[{2}(?!\[+))([\s\S]+?)(?:\]{2}(?!\[+))/g,boneyard:/(^\/\*|^\*\/)$/g,page_break:/^\={3,}$/,line_break:/^ {2}$/,emphasis:/(_|\*{1,3}|_\*{1,3}|\*{1,3}_)(.+)(_|\*{1,3}|_\*{1,3}|\*{1,3}_)/g,bold_italic_underline:/(_{1}\*{3}(?=.+\*{3}_{1})|\*{3}_{1}(?=.+_{1}\*{3}))(.+?)(\*{3}_{1}|_{1}\*{3})/g,bold_underline:/(_{1}\*{2}(?=.+\*{2}_{1})|\*{2}_{1}(?=.+_{1}\*{2}))(.+?)(\*{2}_{1}|_{1}\*{2})/g,italic_underline:/(_{1}\*{1}(?=.+\*{1}_{1})|\*{1}_{1}(?=.+_{1}\*{1}))(.+?)(\*{1}_{1}|_{1}\*{1})/g,bold_italic:/(\*{3}(?=.+\*{3}))(.+?)(\*{3})/g,bold:/(\*{2}(?=.+\*{2}))(.+?)(\*{2})/g,italic:/(\*{1}(?=.+\*{1}))(.+?)(\*{1})/g,underline:/(_{1}(?=.+_{1}))(.+?)(_{1})/g,splitter:/\n{2,}/g,cleaner:/^\n+|\n+$/,standardizer:/\r\n|\r/g,whitespacer:/^\t+|^ {3,}/gm};class lt{reconstruct(e){return e.replace(P.boneyard,`
$1
`).replace(P.standardizer,`
`).replace(P.cleaner,"").replace(P.whitespacer,"")}}class Pn extends lt{constructor(){super(...arguments),this.inline={note:"<!-- $1 -->",line_break:"<br />",bold_italic_underline:'<span class="bold italic underline">$2</span>',bold_underline:'<span class="bold underline">$2</span>',italic_underline:'<span class="italic underline">$2</span>',bold_italic:'<span class="bold italic">$2</span>',bold:'<span class="bold">$2</span>',italic:'<span class="italic">$2</span>',underline:'<span class="underline">$2</span>'}}reconstruct(e){if(!e)return;let t;const n=["bold_italic_underline","bold_underline","italic_underline","bold_italic","bold","italic","underline"];e=e.replace(P.note_inline,this.inline.note).replace(/\\\*/g,"[star]").replace(/\\_/g,"[underline]").replace(/\n/g,this.inline.line_break);for(let r of n)t=P[r],t.test(e)&&(e=e.replace(t,this.inline[r]));return e.replace(/\[star\]/g,"*").replace(/\[underline\]/g,"_").trim()}}class In{constructor(){this.tokens=[]}tokenize(e){const t=new lt().reconstruct(e).split(P.splitter).reverse();let n,r,a;for(n of t){if(P.title_page.test(n)){r=n.replace(P.title_page,`
$1`).split(P.splitter).reverse();for(let s of r){let l=s.replace(P.cleaner,"").split(/\:\n*/);this.tokens.push({type:l[0].trim().toLowerCase().replace(" ","_"),is_title:!0,text:l[1].trim()})}continue}if(r=n.match(P.scene_heading)){let s=r[1]||r[2],l,o;s.indexOf("  ")!==s.length-2&&((l=s.match(P.scene_number))&&(o=l[2],s=s.replace(P.scene_number,"")),this.tokens.push({type:"scene_heading",text:s,scene_number:o||void 0}));continue}if(r=n.match(P.centered)){this.tokens.push({type:"centered",text:r[0].replace(/>|</g,"")});continue}if(r=n.match(P.transition)){this.tokens.push({type:"transition",text:r[1]||r[2]});continue}if(r=n.match(P.dialogue)){let s=r[1]||r[2];if(s.indexOf("  ")!==s.length-2){r[3]&&this.tokens.push({type:"dual_dialogue_end"}),this.tokens.push({type:"dialogue_end"});let l=r[4].split(/(\(.+\))(?:\n+)/).reverse();for(let o of l)o.length>0&&this.tokens.push({type:P.parenthetical.test(o)?"parenthetical":"dialogue",text:o});this.tokens.push({type:"character",text:s.trim()}),this.tokens.push({type:"dialogue_begin",dual:r[3]?"right":a?"left":void 0}),a&&this.tokens.push({type:"dual_dialogue_begin"}),a=!!r[3];continue}}if(r=n.match(P.section)){this.tokens.push({type:"section",text:r[2],depth:r[1].length});continue}if(r=n.match(P.synopsis)){this.tokens.push({type:"synopsis",text:r[1]});continue}if(r=n.match(P.note)){this.tokens.push({type:"note",text:r[1]});continue}if(r=n.match(P.boneyard)){this.tokens.push({type:r[0][0]==="/"?"boneyard_begin":"boneyard_end"});continue}if(r=n.match(P.lyrics)){this.tokens.push({type:"lyrics",text:r[0].replace(/^~(?![ ])/gm,"")});continue}if(P.page_break.test(n)){this.tokens.push({type:"page_break"});continue}if(P.line_break.test(n)){this.tokens.push({type:"line_break"});continue}this.tokens.push({type:"action",text:n.replace(/^!(?![ ])/gm,"")})}return this.tokens.reverse()}}class Ln{constructor(){this.scanner=new In,this.inlineLex=new Pn}parse(e,t){if(typeof e=="undefined"||e===null)throw new Error("Script is undefined or null.");if(typeof e!="string")throw new Error(`Script should be \`string\`, input was \`${Object.prototype.toString.call(e)}\`.`);try{this.tokens=this.scanner.tokenize(e);let n=this.tokens.find(r=>r.type==="title");return{title:n?this.inlineLex.reconstruct(n.text).replace("<br />"," ").replace(/<(?:.|\n)*?>/g,""):void 0,html:{title_page:this.tokens.filter(r=>r.is_title).map(r=>this.to_html(r)).join(""),script:this.tokens.filter(r=>!r.is_title).map(r=>this.to_html(r)).join("")},tokens:t?this.tokens:void 0}}catch(n){throw n.message+=`
Please submit an issue to https://github.com/jonnygreenwald/fountain-js/issues`,n}}to_html(e){switch(e.text=this.inlineLex.reconstruct(e.text),e.type){case"title":return"<h1>"+e.text+"</h1>";case"credit":return'<p class="credit">'+e.text+"</p>";case"author":return'<p class="authors">'+e.text+"</p>";case"authors":return'<p class="authors">'+e.text+"</p>";case"source":return'<p class="source">'+e.text+"</p>";case"notes":return'<p class="notes">'+e.text+"</p>";case"draft_date":return'<p class="draft-date">'+e.text+"</p>";case"date":return'<p class="date">'+e.text+"</p>";case"contact":return'<p class="contact">'+e.text+"</p>";case"copyright":return'<p class="copyright">'+e.text+"</p>";case"scene_heading":return"<h3"+(e.scene_number?' id="'+e.scene_number+'">':">")+e.text+"</h3>";case"transition":return"<h2>"+e.text+"</h2>";case"dual_dialogue_begin":return'<div class="dual-dialogue">';case"dialogue_begin":return'<div class="dialogue'+(e.dual?" "+e.dual:"")+'">';case"character":return"<h4>"+e.text+"</h4>";case"parenthetical":return'<p class="parenthetical">'+e.text+"</p>";case"dialogue":return"<p>"+e.text+"</p>";case"dialogue_end":return"</div>";case"dual_dialogue_end":return"</div>";case"section":return'<p class="section" data-depth="'+e.depth+'">'+e.text+"</p>";case"synopsis":return'<p class="synopsis">'+e.text+"</p>";case"note":return"<!-- "+e.text+" -->";case"boneyard_begin":return"<!-- ";case"boneyard_end":return" -->";case"action":return"<p>"+e.text+"</p>";case"centered":return'<p class="centered">'+e.text+"</p>";case"lyrics":return'<p class="lyrics">'+e.text+"</p>";case"page_break":return"<hr />";case"line_break":return"<br />"}}}function zn(i){let t=new Ln().parse(i,!0);if(t&&t.tokens){let n=[],r=Math.floor(Date.now()/1e3),a;for(let s=0;s<t.tokens.length;s++){let l=t.tokens[s];if(l.type==="scene_heading")a&&(n.push(a),a=void 0),a={id:Ae("1234567890abcdef",12)(),number:l.scene_number,name:l.text,created_at:r,modified_at:r,characters:[],lines:[],selected:!0};else if(l.type==="action")a&&l.text&&a.lines.push({id:Ae("1234567890abcdef",12)(),character:"",extension:"",dialogue:l.text.trim(),delay:0,action:!0,voiceOptions:{}});else if(l.type==="dialogue_begin")a&&a.lines.push({id:Ae("1234567890abcdef",12)(),character:"",extension:"",dialogue:"",delay:0,action:!1,voiceOptions:{}});else if(l.type==="character"){if(a&&l.text){let o=l.text.trim();o.endsWith("(CONT'D)")&&(o=o.slice(0,-8).trim());let u="";const p=/(.+?)\((.+)\)$/;let d=o.match(p);d!==null&&(o=d[1].trim(),u=d[2].trim()),o=Nt(o);let c={name:o,voice:{voiceURI:""},hide:!1,play:!0};a.characters.findIndex(g=>g.name===o)==-1&&a.characters.push(c),a.lines[a.lines.length-1].character=o,a.lines[a.lines.length-1].extension=u}}else if(l.type==="parenthetical"){if(a&&l.text){let o=a.lines[a.lines.length-1].dialogue;o?a.lines[a.lines.length-1].dialogue=o+"<br />"+l.text.trim():a.lines[a.lines.length-1].dialogue=l.text.trim()}}else if(l.type==="dialogue"&&a&&l.text){let o=a.lines[a.lines.length-1].dialogue;o?a.lines[a.lines.length-1].dialogue=o+"<br />"+l.text.trim():a.lines[a.lines.length-1].dialogue=l.text.trim()}}return a&&(n.push(a),a=void 0),n}else return[]}function Bn(i,e){let n=new DOMParser().parseFromString(i,"text/xml");if(n.getElementsByTagName("parsererror").length>0)throw"Could not parse the final draft document.";let a=n.documentElement;if(a.localName!=="FinalDraft")throw"Not FinalDraft document. Root is not FinalDraft.";let s=a.firstElementChild;if(s.localName!=="Content")throw"Not FinalDraft document. Content is not a child of FinalDraft.";if(e==null)throw"No callbacks passed.";e.documentStart();let l=s.children;for(let o=0;o<l.length;o++){let u=l[o];e.paragraphStart(u.getAttribute("Type"));let p=u.children;for(let d=0;d<p.length;d++)p[d].tagName==="Text"&&e.text(p[d].innerHTML,p[d].getAttribute("Style"));e.paragraphEnd()}e.documentEnd()}function On(i){let e="",t="",n="",r="",a,s=new Promise(m=>{a=m});function l(m){return["Scene Heading","Action","Character","Transition","Dialogue","Parenthetical"].includes(m)}function o(m){!l(m)||(t=n,n=m)}function u(){if(!!l(n)){switch(n){case"Trasition":e+=`
${r}

`;break;case"Scene Heading":t!=="Transition"?e+=`
${r}

`:e+=`
${r}

`;break;case"Character":t==="Transition"||t==="Scene Heading"?e+=`${r.toUpperCase()}
`:e+=`
${r.toUpperCase()}
`;break;case"Parenthetical":e+=`${r}
`;break;case"Dialogue":e+=`${r}
`;break;case"Action":t==="Dialogue"||t==="Parenthetical"?e+=`
${r}
`:e+=`${r}
`;break}r=""}}function p(m){return m!=null?m.split("+"):[]}const d=m=>m==="Bold",c=m=>m==="Italic",f=m=>m==="Underline";function g(m,v){return v.find(d)?"**"+m+"**":m}function b(m,v){return v.find(f)?"_"+m+"_":m}function h(m,v){return v.find(c)?"*"+m+"*":m}function T(m,v){let R=p(v);const j=g(m,R),Z=h(j,R),L=b(Z,R);n==="Action"&&m===""?r=r+`
`:r+=L}let M={documentStart:()=>{},documentEnd:()=>{a(e)},paragraphStart:o,paragraphEnd:u,text:T};try{Bn(i,M)}catch(m){return Promise.reject(m)}return s}function Ve(i,e,t){const n=i.slice();return n[40]=e[t],n}function je(i){let e,t,n,r;function a(o){i[21](o)}function s(o){i[22](o)}let l={heading:"Add New Scene",inputLabel:"Name",buttonText:"Add Scene"};return i[3]!==void 0&&(l.open=i[3]),i[4]!==void 0&&(l.value=i[4]),e=new Gt({props:l}),Q.push(()=>X(e,"open",a)),Q.push(()=>X(e,"value",s)),e.$on("submit",i[15]),{c(){E(e.$$.fragment)},l(o){A(e.$$.fragment,o)},m(o,u){N(e,o,u),r=!0},p(o,u){const p={};!t&&u[0]&8&&(t=!0,p.open=o[3],x(()=>t=!1)),!n&&u[0]&16&&(n=!0,p.value=o[4],x(()=>n=!1)),e.$set(p)},i(o){r||(y(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){D(e,o)}}}function Ze(i){let e,t,n;function r(s){i[23](s)}let a={heading:"Delete Scene",buttonText:"Delete",body:"<p>Are you sure you want to delete: <strong>"+i[7]+"</strong>?</p>"};return i[5]!==void 0&&(a.open=i[5]),e=new Kt({props:a}),Q.push(()=>X(e,"open",r)),e.$on("submit",i[24]),e.$on("close",i[25]),{c(){E(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,l){N(e,s,l),n=!0},p(s,l){const o={};l[0]&128&&(o.body="<p>Are you sure you want to delete: <strong>"+s[7]+"</strong>?</p>"),!t&&l[0]&32&&(t=!0,o.open=s[5],x(()=>t=!1)),e.$set(o)},i(s){n||(y(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){D(e,s)}}}function Ye(i){let e,t,n;function r(s){i[26](s)}let a={imported:i[11],script_id:ae};return i[1]!==void 0&&(a.open=i[1]),e=new gn({props:a}),Q.push(()=>X(e,"open",r)),{c(){E(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,l){N(e,s,l),n=!0},p(s,l){const o={};l[0]&2048&&(o.imported=s[11]),!t&&l[0]&2&&(t=!0,o.open=s[1],x(()=>t=!1)),e.$set(o)},i(s){n||(y(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){D(e,s)}}}function Fn(i){let e;return{c(){e=K("More info")},l(t){e=W(t,"More info")},m(t,n){C(t,e,n)},d(t){t&&k(e)}}}function Un(i){let e,t,n,r,a,s,l,o,u;return l=new Wt({props:{href:"https://fountain.io",target:"_blank",$$slots:{default:[Fn]},$$scope:{ctx:i}}}),{c(){e=q("ul"),t=q("li"),n=K("Only Fountain script files (and some Final Draft files) are currently importable."),r=U(),a=q("li"),s=K("Fountain is the easiest format for teachers and scene partners to collaborate: "),E(l.$$.fragment),o=K(".")},l(p){e=G(p,"UL",{});var d=B(e);t=G(d,"LI",{});var c=B(t);n=W(c,"Only Fountain script files (and some Final Draft files) are currently importable."),c.forEach(k),r=H(d),a=G(d,"LI",{});var f=B(a);s=W(f,"Fountain is the easiest format for teachers and scene partners to collaborate: "),A(l.$$.fragment,f),o=W(f,"."),f.forEach(k),d.forEach(k)},m(p,d){C(p,e,d),F(e,t),F(t,n),F(e,r),F(e,a),F(a,s),N(l,a,null),F(a,o),u=!0},p(p,d){const c={};d[1]&8192&&(c.$$scope={dirty:d,ctx:p}),l.$set(c)},i(p){u||(y(l.$$.fragment,p),u=!0)},o(p){S(l.$$.fragment,p),u=!1},d(p){p&&k(e),D(l)}}}function Hn(i){let e,t;return e=new Qt({props:{title:"Error:",subtitle:i[19]("error"),timeout:4e3}}),{c(){E(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,r){N(e,n,r),t=!0},p:ge,i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function Rn(i){let e,t,n,r,a,s;return e=new Ft({}),e.$on("call",i[28]),e.$on("hangup",i[29]),e.$on("pickup",i[30]),n=new Mn({props:{inProgress:i[9]}}),n.$on("change",i[31]),a=new Jt({props:{icon:Ut}}),a.$on("click",i[14]),{c(){E(e.$$.fragment),t=U(),E(n.$$.fragment),r=U(),E(a.$$.fragment)},l(l){A(e.$$.fragment,l),t=H(l),A(n.$$.fragment,l),r=H(l),A(a.$$.fragment,l)},m(l,o){N(e,l,o),C(l,t,o),N(n,l,o),C(l,r,o),N(a,l,o),s=!0},p(l,o){const u={};o[0]&512&&(u.inProgress=l[9]),n.$set(u)},i(l){s||(y(e.$$.fragment,l),y(n.$$.fragment,l),y(a.$$.fragment,l),s=!0)},o(l){S(e.$$.fragment,l),S(n.$$.fragment,l),S(a.$$.fragment,l),s=!1},d(l){D(e,l),l&&k(t),D(n,l),l&&k(r),D(a,l)}}}function qe(i){let e,t;return e=new Ht({props:{code:i[8]}}),{c(){E(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,r){N(e,n,r),t=!0},p(n,r){const a={};r[0]&256&&(a.code=n[8]),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function Ge(i){let e,t,n;function r(s){i[32](s)}let a={};return i[2]!==void 0&&(a.text=i[2]),e=new Rt({props:a}),Q.push(()=>X(e,"text",r)),{c(){E(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,l){N(e,s,l),n=!0},p(s,l){const o={};!t&&l[0]&4&&(t=!0,o.text=s[2],x(()=>t=!1)),e.$set(o)},i(s){n||(y(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){D(e,s)}}}function Vn(i){let e=i[19]("error"),t,n,r,a,s,l,o=e&&Hn(i);n=new Ot({props:{$$slots:{default:[Rn]},$$scope:{ctx:i}}});let u=i[8]&&qe(i),p=i[2]&&Ge(i);return{c(){o&&o.c(),t=U(),E(n.$$.fragment),r=U(),u&&u.c(),a=U(),p&&p.c(),s=le()},l(d){o&&o.l(d),t=H(d),A(n.$$.fragment,d),r=H(d),u&&u.l(d),a=H(d),p&&p.l(d),s=le()},m(d,c){o&&o.m(d,c),C(d,t,c),N(n,d,c),C(d,r,c),u&&u.m(d,c),C(d,a,c),p&&p.m(d,c),C(d,s,c),l=!0},p(d,c){e&&o.p(d,c);const f={};c[0]&16134|c[1]&8192&&(f.$$scope={dirty:c,ctx:d}),n.$set(f),d[8]?u?(u.p(d,c),c[0]&256&&y(u,1)):(u=qe(d),u.c(),y(u,1),u.m(a.parentNode,a)):u&&(he(),S(u,1,1,()=>{u=null}),_e()),d[2]?p?(p.p(d,c),c[0]&4&&y(p,1)):(p=Ge(d),p.c(),y(p,1),p.m(s.parentNode,s)):p&&(he(),S(p,1,1,()=>{p=null}),_e())},i(d){l||(y(o),y(n.$$.fragment,d),y(u),y(p),l=!0)},o(d){S(o),S(n.$$.fragment,d),S(u),S(p),l=!1},d(d){o&&o.d(d),d&&k(t),D(n,d),d&&k(r),u&&u.d(d),d&&k(a),p&&p.d(d),d&&k(s)}}}function jn(i){let e,t=i[40].number?i[40].number+". ":"",n,r=i[40].name+"",a,s,l,o;return l=new xt({props:{style:"float: right; vertical-align: middle;",size:20}}),{c(){e=q("p"),n=K(t),a=K(r),s=U(),E(l.$$.fragment),this.h()},l(u){e=G(u,"P",{style:!0});var p=B(e);n=W(p,t),a=W(p,r),p.forEach(k),s=H(u),A(l.$$.fragment,u),this.h()},h(){re(e,"font-family","Courier"),re(e,"font-size","12px"),re(e,"text-align","center"),re(e,"text-transform","uppercase"),re(e,"margin-bottom","0px"),re(e,"padding-bottom","0")},m(u,p){C(u,e,p),F(e,n),F(e,a),C(u,s,p),N(l,u,p),o=!0},p(u,p){(!o||p[0]&8192)&&t!==(t=u[40].number?u[40].number+". ":"")&&fe(n,t),(!o||p[0]&8192)&&r!==(r=u[40].name+"")&&fe(a,r)},i(u){o||(y(l.$$.fragment,u),o=!0)},o(u){S(l.$$.fragment,u),o=!1},d(u){u&&k(e),u&&k(s),D(l,u)}}}function Zn(i){let e,t,n,r,a,s;t=new Xt({props:{oncontextmenu:"return false",href:"/scripts/"+ae+"/"+i[40].id+"---"+encodeURIComponent(Ne(i[40].name)),draggable:"false",style:`
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            user-select: none;
            border-bottom: 2px double black;
          `,$$slots:{default:[jn]},$$scope:{ctx:i}}});let l=[{draggable:"false"},i[43],{"data-long-press-delay":"1200"}],o={};for(let d=0;d<l.length;d+=1)o=V(o,l[d]);function u(...d){return i[34](i[40],...d)}function p(...d){return i[35](i[40],...d)}return{c(){e=q("div"),E(t.$$.fragment),n=U(),this.h()},l(d){e=G(d,"DIV",{draggable:!0,"data-long-press-delay":!0});var c=B(e);A(t.$$.fragment,c),c.forEach(k),n=H(d),this.h()},h(){we(e,o)},m(d,c){C(d,e,c),N(t,e,null),C(d,n,c),r=!0,a||(s=[Y(e,"long-press",u),Y(e,"click",p)],a=!0)},p(d,c){i=d;const f={};c[0]&8192&&(f.href="/scripts/"+ae+"/"+i[40].id+"---"+encodeURIComponent(Ne(i[40].name))),c[0]&8192|c[1]&8192&&(f.$$scope={dirty:c,ctx:i}),t.$set(f),we(e,o=ve(l,[{draggable:"false"},c[1]&4096&&i[43],{"data-long-press-delay":"1200"}]))},i(d){r||(y(t.$$.fragment,d),r=!0)},o(d){S(t.$$.fragment,d),r=!1},d(d){d&&k(e),D(t),d&&k(n),a=!1,Me(s)}}}function Ke(i,e){let t,n,r;return n=new Vt({props:{as:!0,$$slots:{default:[Zn,({props:a})=>({43:a}),({props:a})=>[0,a?4096:0]]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=le(),E(n.$$.fragment),this.h()},l(a){t=le(),A(n.$$.fragment,a),this.h()},h(){this.first=t},m(a,s){C(a,t,s),N(n,a,s),r=!0},p(a,s){e=a;const l={};s[0]&8192|s[1]&12288&&(l.$$scope={dirty:s,ctx:e}),n.$set(l)},i(a){r||(y(n.$$.fragment,a),r=!0)},o(a){S(n.$$.fragment,a),r=!1},d(a){a&&k(t),D(n,a)}}}function Yn(i){let e=[],t=new Map,n,r,a=i[13].scripts[J()].scenes;const s=l=>l[40].id;for(let l=0;l<a.length;l+=1){let o=Ve(i,a,l),u=s(o);t.set(u,e[l]=Ke(u,o))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();n=le()},l(l){for(let o=0;o<e.length;o+=1)e[o].l(l);n=le()},m(l,o){for(let u=0;u<e.length;u+=1)e[u].m(l,o);C(l,n,o),r=!0},p(l,o){o[0]&401408|o[1]&4096&&(a=l[13].scripts[J()].scenes,he(),e=$e(e,o,s,1,l,a,t,n.parentNode,et,Ke,n,Ve),_e())},i(l){if(!r){for(let o=0;o<a.length;o+=1)y(e[o]);r=!0}},o(l){for(let o=0;o<e.length;o+=1)S(e[o]);r=!1},d(l){for(let o=0;o<e.length;o+=1)e[o].d(l);l&&k(n)}}}function qn(i){let e,t;return e=new Lt({props:{$$slots:{default:[Yn]},$$scope:{ctx:i}}}),{c(){E(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,r){N(e,n,r),t=!0},p(n,r){const a={};r[0]&8192|r[1]&8192&&(a.$$scope={dirty:r,ctx:n}),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function Gn(i){let e,t,n,r,a,s,l,o,u,p,d,c=i[3]&&je(i),f=i[5]&&Ze(i),g=i[1]&&Ye(i);function b(m){i[27](m)}let h={size:"xs",passiveModal:!0,modalHeading:"Import Error",$$slots:{default:[Un]},$$scope:{ctx:i}};i[12]!==void 0&&(h.open=i[12]),r=new jt({props:h}),Q.push(()=>X(r,"open",b));function T(m){i[33](m)}let M={persistentHamburgerMenu:!0,company:"SCENES",platformName:it,iconMenu:ze,iconClose:ze,$$slots:{default:[Vn]},$$scope:{ctx:i}};return i[0]!==void 0&&(M.isSideNavOpen=i[0]),l=new Dt({props:M}),Q.push(()=>X(l,"isSideNavOpen",T)),p=new Mt({props:{$$slots:{default:[qn]},$$scope:{ctx:i}}}),{c(){c&&c.c(),e=U(),f&&f.c(),t=U(),g&&g.c(),n=U(),E(r.$$.fragment),s=U(),E(l.$$.fragment),u=U(),E(p.$$.fragment)},l(m){c&&c.l(m),e=H(m),f&&f.l(m),t=H(m),g&&g.l(m),n=H(m),A(r.$$.fragment,m),s=H(m),A(l.$$.fragment,m),u=H(m),A(p.$$.fragment,m)},m(m,v){c&&c.m(m,v),C(m,e,v),f&&f.m(m,v),C(m,t,v),g&&g.m(m,v),C(m,n,v),N(r,m,v),C(m,s,v),N(l,m,v),C(m,u,v),N(p,m,v),d=!0},p(m,v){m[3]?c?(c.p(m,v),v[0]&8&&y(c,1)):(c=je(m),c.c(),y(c,1),c.m(e.parentNode,e)):c&&(he(),S(c,1,1,()=>{c=null}),_e()),m[5]?f?(f.p(m,v),v[0]&32&&y(f,1)):(f=Ze(m),f.c(),y(f,1),f.m(t.parentNode,t)):f&&(he(),S(f,1,1,()=>{f=null}),_e()),m[1]?g?(g.p(m,v),v[0]&2&&y(g,1)):(g=Ye(m),g.c(),y(g,1),g.m(n.parentNode,n)):g&&(he(),S(g,1,1,()=>{g=null}),_e());const R={};v[1]&8192&&(R.$$scope={dirty:v,ctx:m}),!a&&v[0]&4096&&(a=!0,R.open=m[12],x(()=>a=!1)),r.$set(R);const j={};v[0]&16134|v[1]&8192&&(j.$$scope={dirty:v,ctx:m}),!o&&v[0]&1&&(o=!0,j.isSideNavOpen=m[0],x(()=>o=!1)),l.$set(j);const Z={};v[0]&8192|v[1]&8192&&(Z.$$scope={dirty:v,ctx:m}),p.$set(Z)},i(m){d||(y(c),y(f),y(g),y(r.$$.fragment,m),y(l.$$.fragment,m),y(p.$$.fragment,m),d=!0)},o(m){S(c),S(f),S(g),S(r.$$.fragment,m),S(l.$$.fragment,m),S(p.$$.fragment,m),d=!1},d(m){c&&c.d(m),m&&k(e),f&&f.d(m),m&&k(t),g&&g.d(m),m&&k(n),D(r,m),m&&k(s),D(l,m),m&&k(u),D(p,m)}}}let ae,it;async function ll({params:i}){if(location.hostname.toLowerCase()!=="petersir.com")throw"Unknown error";let e=i.script.split("---",2);if(e.length===0)return Te("/scripts",{replaceState:!0}),{};ae=e[0];let t=nt($).scripts,n=t.findIndex(r=>r.id===ae);if(n!==-1)return it=t[n].name,{status:200};{let r="Could not find script: "+ae;return e.length===2&&(r=r+" ("+e[1]+")"),{status:404,error:r}}}function J(){let i=nt($).scripts.findIndex(e=>e.id===ae);if(i!==-1)return i;Te("/scripts?error=Script no longer exists.",{replaceState:!0})}function We(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function Kn(i,e,t){let n,r,a;Ee(i,en,w=>t(20,n=w)),Ee(i,Zt,w=>t(38,r=w)),Ee(i,$,w=>t(13,a=w));let s=!1;{let w=r.url.searchParams.get("code");w&&(Pt(w).then(()=>{t(2,s="")}).catch(z=>{z.message.includes("404")?t(2,s="The code is not valid."):z.name==="NotFoundError"?t(2,s="No microphone is connected."):z.name==="NotAllowedError"?t(2,s="Please give permission to access microphone."):t(2,s="Something went wrong. Please try again.")}),It({code:null}))}tt(()=>{wt(()=>import("../../../chunks/long-press-event-178b6011.js"),[]),Ce($,a.scripts[J()].scenes=a.scripts[J()].scenes.sort((w,z)=>w.number&&z.number?w.modified_at-z.modified_at:z.modified_at-w.modified_at),a)});let l=!1,o="";function u(){t(4,o=""),t(3,l=!0)}function p(){t(3,l=!1);let w=Math.floor(Date.now()/1e3);a.scripts[J()].scenes.unshift({id:Ae("1234567890abcdef",12)(),number:void 0,name:o.trim(),characters:[],lines:[],created_at:w,modified_at:w}),Ce($,a.scripts[J()].modified_at=w,a),t(4,o="")}function d(w){Ce($,a.scripts[J()].scenes=a.scripts[J()].scenes.filter(function(z){return z.id!==w}),a),Ce($,a.scripts[J()].modified_at=Math.floor(Date.now()/1e3),a),t(5,c=!1),t(7,g=""),t(6,f="")}let c=!1,f="",g="";function b(w){let z=a.scripts[J()].scenes.find(be=>be.id===w);z&&(t(5,c=!0),t(7,g=z.name),t(6,f=w))}function h(w,z){w.preventDefault(),We()&&b(z)}let T=0,M;function m(w,z,be,pe){w.preventDefault();let ke="/scripts/"+z+"/"+be+"---"+encodeURIComponent(pe);if(We()){Te(ke);return}T++,Yt(ke),T===1?M=setTimeout(()=>{T=0,clearTimeout(M),Te(ke)},400):T===2?(clearTimeout(M),T=0,b(be)):(clearTimeout(M),T=0)}function v(w){return r.url.searchParams.get(w)}let R,j="",Z=!1,L,ie=!1,_=[];St(()=>{L&&L.abort()});let Se=!1;function st(w){l=w,t(3,l)}function rt(w){o=w,t(4,o)}function at(w){c=w,t(5,c)}const ot=()=>{d(f)},ft=()=>{t(6,f=""),t(7,g="")};function ut(w){ie=w,t(1,ie)}function ct(w){Se=w,t(12,Se)}const dt=()=>{zt().then(w=>{t(8,j=w)}).catch(w=>{t(8,j=""),w.name==="NotFoundError"?t(2,s="No microphone is connected."):w.name==="NotAllowedError"?t(2,s="Please give permission to access microphone."):t(2,s="Something went wrong. Please try again.")})},pt=()=>{t(8,j="")},mt=async()=>{t(2,s=await Bt())},ht=w=>{let z=w.detail[0],be=z.name.split(".").pop();L&&L.abort(),t(10,L=new window.FileReader),t(10,L.onabort=function(pe){t(9,Z=!1),t(11,_=[])},L),t(10,L.onerror=function(pe){t(9,Z=!1)},L),t(10,L.onloadend=function(pe){t(9,Z=!1)},L),t(10,L.onloadstart=function(pe){t(9,Z=!0)},L),t(10,L.onload=function(pe){let ke=pe.target.result;function Ie(Le){let se=zn(Le);if(se.length===0){t(12,Se=!0);return}else se.length===1?(delete se[0].selected,a.scripts[J()].scenes.unshift(se[0]),Ce($,a.scripts[J()].modified_at=Math.floor(Date.now()/1e3),a)):(t(11,_=se),t(1,ie=!0))}be==="fdx"?On(ke).then(se=>{Ie(se)}).catch(se=>{t(12,Se=!0)}):Ie(ke)},L),L.readAsText(z)};function _t(w){s=w,t(2,s)}function gt(w){R=w,t(0,R)}const bt=(w,z)=>{h(z,w.id)},kt=(w,z)=>m(z,ae,w.id,Ne(w.name));return i.$$.update=()=>{i.$$.dirty[0]&1&&R&&(Te("/scripts"),t(0,R=!1)),i.$$.dirty[0]&1048576&&n.callState!==$t.Calling&&t(8,j=""),i.$$.dirty[0]&2&&(ie||t(11,_=[]))},[R,ie,s,l,o,c,f,g,j,Z,L,_,Se,a,u,p,d,h,m,v,n,st,rt,at,ot,ft,ut,ct,dt,pt,mt,ht,_t,gt,bt,kt]}class il extends ue{constructor(e){super(),ce(this,e,Kn,Gn,de,{},null,[-1,-1])}}export{il as default,ll as load};
